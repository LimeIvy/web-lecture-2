# 環境構築

このリポジトリを動かすための環境構築手順です。

## 必要な環境

- **Node.js**: v18以上（推奨: v20以上）
- **npm**: Node.jsに同梱（v9以上推奨）
- **Git**: リポジトリのクローン用

## 1. Node.jsのインストール

### Windows

1. [Node.js公式サイト](https://nodejs.org/ja/)にアクセス
2. LTS（推奨版）をダウンロード
3. インストーラーを実行し、指示に従ってインストール
4. インストール後、コマンドプロンプトまたはPowerShellで確認：
   ```bash
   node --version
   npm --version
   ```

## 2. Gitのインストール

### Windows

1. [Git公式サイト](https://git-scm.com/download/win)からダウンロード
2. インストーラーを実行し、デフォルト設定でインストール
3. インストール後、コマンドプロンプトまたはPowerShellで確認：
   ```bash
   git --version
   ```

## 3. リポジトリのクローン

### GitHubからクローンする場合

```bash
git clone https://github.com/LimeIvy/web-lecture-2
cd web-lecture-2
```

## 4. プロジェクトのセットアップ

### バックエンドのセットアップ

```bash
# バックエンドディレクトリに移動
cd backend

# 依存関係をインストール
npm install

# 開発サーバーを起動
npm run dev
```

バックエンドサーバーは `http://localhost:8080` で起動します。

**注意**: 初回起動時、`x_clone.db` ファイルが自動的に作成され、テーブルとサンプルデータが初期化されます。

### フロントエンドのセットアップ

新しいターミナル/コマンドプロンプトを開いて：

```bash
# フロントエンドディレクトリに移動
cd frontend

# 依存関係をインストール
npm install

# 開発サーバーを起動
npm run dev
```

フロントエンド開発サーバーは `http://localhost:5173` で起動します。

## 5. 動作確認

### バックエンドの確認

ブラウザで以下のURLにアクセス：

- `http://localhost:8080/` → `{"message":"Hello!"}` が表示されれば正常
- `http://localhost:8080/posts` → JSON形式の投稿データが表示されれば正常

### フロントエンドの確認

ブラウザで `http://localhost:5173` にアクセス：

- アプリケーションが表示され、投稿一覧が表示されれば正常

## トラブルシューティング

### Node.jsのバージョンが古い場合

```bash
# 現在のバージョンを確認
node --version

# v18未満の場合は、最新版にアップグレード
```

### npm installでエラーが発生する場合

```bash
# npmのキャッシュをクリア
npm cache clean --force

# node_modulesとpackage-lock.jsonを削除して再インストール
rm -rf node_modules package-lock.json
npm install
```

### ポートが既に使用されている場合

- **バックエンド（8080）**: `backend/src/index.ts` の `port` 変数を変更
- **フロントエンド（5173）**: `vite.config.ts` でポートを変更、または `npm run dev -- --port 3000` のように指定

### SQLiteデータベースのリセット

データベースをリセットしたい場合：

```bash
# backendディレクトリで
rm x_clone.db

# サーバーを再起動すると、新しいデータベースが作成されます
npm run dev
```
